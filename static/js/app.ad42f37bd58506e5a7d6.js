webpackJsonp([1],{"BI6/":function(t,e){},IpWz:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={};s.d(n,"BEFORE",function(){return O}),s.d(n,"TRADING",function(){return I}),s.d(n,"CHICAGO",function(){return K}),s.d(n,"PLAYING",function(){return M}),s.d(n,"AFTER",function(){return b});var a=s("/5sW"),i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{visibility:"hidden",height:"0",width:"0"}},t._l(t.cards.suits,function(e){return s("div",t._l(t.cards.values,function(n){return s("img",{attrs:{src:t.getSrc(n,e)}})}))}))},staticRenderFns:[]},r={name:"app",components:{Preloader:s("VU/8")({methods:{getSrc:function(t,e){return this.getCardUrl({value:t,suit:e})}},data:function(){return{cards:{suits:{HEARTS:"HEARTS",SPADES:"SPADES",DIAMONDS:"DIAMONDS",CLUBS:"CLUBS"},values:{TWO:"TWO",THREE:"THREE",FOUR:"FOUR",FIVE:"FIVE",SIX:"SIX",SEVEN:"SEVEN",EIGHT:"EIGHT",NINE:"NINE",TEN:"TEN",JACK:"JACK",QUEEN:"QUEEN",KING:"KING",ACE:"ACE"}}}}},i,!1,null,null,null).exports}},c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view"),this._v(" "),e("Preloader")],1)},staticRenderFns:[]};var o,l=s("VU/8")(r,c,!1,function(t){s("U1vt")},null,null).exports,u=s("bOdI"),d=s.n(u),m=s("NYxO"),h={state:{isMyTurn:!1,hand:[],id:"",name:"",score:0,hasTakenChicago:!1,winner:!1},mutations:(o={},d()(o,"SET_MY_HAND",function(t,e){t.hand=e}),d()(o,"SET_MY_TURN",function(t,e){t.isMyTurn=e}),d()(o,"SET_MY_PLAYER",function(t,e){t.id=e.id,t.name=e.name,t.score=e.score,t.hasTakenChicago=e.hasTakenChicago,t.winner=e.winner}),o)},v=s("/ocq"),f=s("BO1k"),C=s.n(f),p=s("Zrlr"),_=s.n(p),g=function t(e,s){_()(this,t),this.nickname=e,this.key=s},E=s("mvHQ"),y=s.n(E),k=s("pFYg"),R=s.n(k),T=function t(e,s){_()(this,t),(void 0===s?"undefined":R()(s))!==R()("")&&(s=y()(s)),this.type=e,this.value=s},N={name:"Start",props:{urlKey:{type:String,default:""},errors:{type:Object,required:!0}},data:function(){return{invKey:"",nickname:""}},methods:{createGame:function(){if(this.hasNicknameSet){var t=new T("NEW_GAME",this.nickname);this.$emit("action",t)}},joinGame:function(){if(this.fieldsAreValid){var t=new g(this.nickname,this.invKey),e=new T("JOIN_GAME",t);this.$emit("action",e)}},dangerIfExists:function(t){return this[t]?"is-danger":""},handleKeyupEnter:function(){this.invKey?this.joinGame():this.createGame()}},computed:{hasNicknameSet:function(){return this.nickname.length>0},hasKeySet:function(){var t=this.invKey.split("-");if(5===t.length){var e=!0,s=!1,n=void 0;try{for(var a,i=C()(t);!(e=(a=i.next()).done);e=!0){if(""===a.value)return!1}}catch(t){s=!0,n=t}finally{try{!e&&i.return&&i.return()}finally{if(s)throw n}}return!0}return!1},hasErrors:function(){return this.errors.invKey.length>0||this.errors.nickname.length>0},fieldsAreValid:function(){return!this.hasErrors&&this.hasNicknameSet&&this.hasKeySet}},created:function(){this.invKey=this.urlKey||""},watch:{invKey:function(){this.$emit("changeKey")},nickname:function(){this.$emit("changeNick")}}},S={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("label",{staticClass:"label is-large"},[t._v("Nickname")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.nickname,expression:"nickname"}],staticClass:"input is-large",class:t.dangerIfExists(t.errors.nickname),attrs:{placeholder:"Choose a nickname..."},domProps:{value:t.nickname},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleKeyupEnter(e):null},input:function(e){e.target.composing||(t.nickname=e.target.value)}}}),t._v(" "),t.errors.nickname?s("p",{staticClass:"help is-danger"},[t._v("\n              "+t._s(t.errors.nickname)+"\n            ")]):t._e()])]),t._v(" "),s("div",{staticClass:"columns"},[s("div",{staticClass:"column is-expanded"},[s("div",{staticClass:"field has-addons is-fullwidth"},[s("div",{staticClass:"control is-expanded"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.invKey,expression:"invKey"}],staticClass:"input is-large",class:t.dangerIfExists(t.errors.invKey),attrs:{type:"text",placeholder:"Invitation key"},domProps:{value:t.invKey},on:{input:function(e){e.target.composing||(t.invKey=e.target.value)}}}),t._v(" "),t.errors.invKey?s("p",{staticClass:"help is-danger"},[t._v("\n                      "+t._s(t.errors.invKey)+"\n                    ")]):t._e()]),t._v(" "),s("div",{staticClass:"control"},[s("a",{staticClass:"button is-info is-large",attrs:{disabled:!t.fieldsAreValid},on:{click:t.joinGame}},[t._v("\n                    Join existing game\n                  ")])])])]),t._v(" "),s("div",{staticClass:"column is-narrow"},[s("button",{staticClass:"button is-primary is-large",attrs:{disabled:!t.hasNicknameSet},on:{click:t.createGame}},[t._v("\n                Create new game\n              ")])])])])])},staticRenderFns:[]};var A=s("VU/8")(N,S,!1,function(t){s("ia/M")},null,null).exports,O="BEFORE",I="TRADING",K="CHICAGO",M="PLAYING",b="AFTER",w={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"media"},[s("div",{staticClass:"media-left"},[s("figure",{staticClass:"image is-96x96"},[s("img",{staticClass:"avatar",attrs:{src:t.getAvatarUrl(t.user)}})])]),t._v(" "),s("div",{staticClass:"media-content",staticStyle:{"max-height":"96px"}},[s("h1",{staticClass:"title",staticStyle:{"margin-bottom":"1rem"}},[t._v(t._s(t.user.name||"You"))]),t._v(" "),s("h2",{staticClass:"title is-3"},[s("span",{staticClass:"tag is-large"},[t._v(t._s(t.user.score)+" points")]),t._v(" "),t.user.hasTakenChicago?s("span",{staticClass:"tag is-large"},[t._v("C")]):t._e(),t._v(" "),t.user.winner?s("span",{staticClass:"tag is-large"},[t._v("WINNER")]):t._e()])])])},staticRenderFns:[]},P={props:["game","me","markedCards"],name:"Controls",components:{UserArea:s("VU/8")({name:"UserArea",props:["user"]},w,!1,null,null,null).exports},data:function(){return{copiedKey:!1,inviteText:"Invite friends",phase:n}},methods:{startGame:function(){this.doAction(new T("START_GAME"))},trade:function(){this.doAction(new T("THROW",this.markedCards))},passTrade:function(){this.doAction(new T("THROW",[]))},callChicago:function(){this.doAction(new T("CHICAGO",!0))},passChicago:function(){this.doAction(new T("CHICAGO",!1))},play:function(){this.doAction(new T("MOVE",this.markedCard))},restartGame:function(){this.doAction(new T("RESTART_GAME"))},doAction:function(t){this.$store.dispatch("SEND_ACTION",t),this.$emit("action")},isPhase:function(t){return this.game.round.phase===t},isCurrentPlayer:function(t){return t.id===this.game.round.currentPlayer.id},copyKeyToClipboard:function(){this.selectElementText(this.$refs.keySpan),document.execCommand("copy"),this.copiedKey=!0},selectElementText:function(t){var e=window,s=e.document,n=void 0,a=void 0;e.getSelection&&s.createRange?(n=e.getSelection(),(a=s.createRange()).selectNodeContents(t),n.removeAllRanges(),n.addRange(a)):s.body.createTextRange&&((a=s.body.createTextRange()).moveToElementText(t),a.select())}},computed:{checkOrKey:function(){return this.copiedKey?"fa fa-check":"fa fa-key"},canStart:function(){return this.me.id===this.game.host.id&&this.game.players.length>1&&!this.game.started},canRestart:function(){return this.me.id===this.game.host.id&&this.game.hasWinners},markedCard:function(){return 1===this.markedCards.length&&this.markedCards[0]}}},x={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("div",{staticClass:"columns"},[s("div",{staticClass:"column"},[s("UserArea",{attrs:{user:t.me}})],1),t._v(" "),s("div",{staticClass:"column is-narrow"},[t.game.started?t._e():s("span",{staticClass:"tag is-medium is-primary",on:{click:t.copyKeyToClipboard,mouseover:function(e){t.inviteText=""},mouseleave:function(e){t.inviteText="Invite friends"}}},[s("span",{staticClass:"icon"},[s("i",{class:t.checkOrKey})]),t._v(" "),s("span",{ref:"keySpan"},[t._v(t._s(t.inviteText||t.game.invKey))])]),t._v(" "),t.canStart&&!t.canRestart?s("a",{staticClass:"tag is-medium",on:{click:t.startGame}},[t._v("Start game")]):t._e(),t._v(" "),t.canRestart?s("a",{staticClass:"tag is-medium is-warning",on:{click:t.restartGame}},[t._m(0),t._v(" "),s("span",[t._v("Restart")])]):t._e(),t._v(" "),t.me.isMyTurn?s("span",[t.isPhase(t.phase.TRADING)?s("span",[t.markedCards.length?s("a",{staticClass:"tag is-success is-medium",on:{click:t.trade}},[t._v("TRADE ("+t._s(t.markedCards.length)+")")]):s("a",{staticClass:"tag is-info is-medium",on:{click:t.passTrade}},[t._v("YOUR TURN (PASS)")])]):t._e(),t._v(" "),t.isPhase(t.phase.CHICAGO)?s("span",[s("span",[t._v("Want Chicago?")]),t._v(" "),s("a",{staticClass:"tag is-success is-medium",on:{click:t.callChicago}},[t._v("YES")]),t._v(" "),s("a",{staticClass:"tag is-danger is-medium",on:{click:t.passChicago}},[t._v("NO")])]):t._e(),t._v(" "),t.isPhase(t.phase.PLAYING)?s("span",[t.markedCard?s("a",{staticClass:"tag is-success is-medium",on:{click:t.play}},[t._v("PLAY CARD")]):s("span",{staticClass:"tag is-black is-medium"},[t._v("YOUR TURN")])]):t._e()]):s("span",[s("span",{staticClass:"tag is-warning is-medium"},[t._v("WAITING")])])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fa fa-refresh"})])}]};var G=s("VU/8")(P,x,!1,function(t){s("wxSZ")},"data-v-1d4a7f36",null).exports,U={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("div",{staticClass:"columns"},t._l(t.players,function(e,n){return s("div",{staticClass:"column"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-content"},[s("div",{staticClass:"media"},[s("div",{staticClass:"media-left"},[s("figure",{staticClass:"image is-48x48"},[s("img",{staticClass:"avatar",attrs:{src:t.getAvatarUrl(e),alt:"Placeholder image"}})])]),t._v(" "),s("div",{staticClass:"media-content"},[s("div",{staticClass:"columns"},[s("div",{staticClass:"column is-narrow"},[s("p",{staticClass:"title is-4"},[t._v("\n                      "+t._s(e.name||"Player "+(n+1))+"\n                    ")]),t._v(" "),s("p",{staticClass:"subtitle is-6"},[t._v("\n                      "+t._s(e.score)+" points\n                    ")])]),t._v(" "),s("div",{staticClass:"column is-expanded"},[e.hand?s("div",t._l(e.hand.played,function(e){return s("figure",{staticClass:"image is-inline-flex",staticStyle:{width:"33px",height:"48px"}},[s("img",{class:t.isBaseCard(e)?"baseCard":"",attrs:{src:t.getCardUrl(e),alt:e.type+""+e.value}})])})):t._e()]),t._v(" "),s("div",{staticClass:"column is-narrow"},[e.hasTakenChicago?s("span",{staticClass:"tag is-light",staticStyle:{"margin-left":"10px"}},[t._v("\n                      C\n                    ")]):t._e(),t._v(" "),t.isCurrentPlayer(e)?s("span",{staticClass:"tag is-info",staticStyle:{"margin-left":"10px"}},[t._v("\n                      THEIR TURN\n                    ")]):t._e(),t._v(" "),e.winner?s("span",{staticClass:"tag is-success",staticStyle:{"margin-left":"10px"}},[t._v("\n                      WINNER\n                    ")]):t._e()])])])])])])])}))])])},staticRenderFns:[]};var H=s("VU/8")({name:"Players",props:["players","baseMove","currentPlayer"],methods:{isBaseCard:function(t){return!!this.baseMove&&t.suit===this.baseMove.card.suit&&t.value===this.baseMove.card.value},isCurrentPlayer:function(t){return this.currentPlayer&&this.currentPlayer.id===t.id}}},U,!1,function(t){s("wF0S")},"data-v-006ce711",null).exports,D={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("div",{staticClass:"columns is-mobile"},t._l(t.me.hand,function(e){return s("div",{staticClass:"column has-text-centered"},[s("img",{staticClass:"playingCard",class:t.getCardClasses(e),attrs:{src:t.getCardUrl(e)},on:{click:function(s){t.toggleMark(e)}}})])}))])])},staticRenderFns:[]};var $=s("VU/8")({props:["me","phase","markedCards"],name:"MyHand",methods:{toggleMark:function(t){this.$emit("toggleMark",t)},isMarked:function(t){return this.markedCards.includes(t)},getCardClasses:function(t){return this.me.isMyTurn?this.isMarked(t)?"markedCard myTurn":"myTurn":""}}},D,!1,function(t){s("BI6/")},"data-v-74bc1474",null).exports,F={name:"Game",props:{game:{type:Object,required:!0},me:{type:Object,required:!0}},components:{Controls:G,Players:H,MyHand:$},data:function(){return{markedCards:[]}},methods:{toggleMark:function(t){this.me.isMyTurn&&!this.isPhase(K)?this.isPhase(M)?this.markSingle(t):this.isMarked(t)?this.unmark(t):this.mark(t):this.unmarkAll()},unmark:function(t){this.markedCards=this.markedCards.filter(function(e){return e!==t})},unmarkAll:function(){this.markedCards=[]},mark:function(t){this.markedCards.push(t)},markSingle:function(t){this.markedCards=[t]},isMarked:function(t){return this.markedCards.includes(t)},isPhase:function(t){return this.game.round.phase===t}},computed:{baseMove:function(){if(this.currentTrick)return this.currentTrick.moves&&this.currentTrick.moves.length>0&&this.currentTrick.moves[0]},currentTrick:function(){var t=this.game.round,e=t&&t.tricks;if(e)return e.length>0&&e[e.length-1]},currentPlayer:function(){return this.game.round&&this.game.round.currentPlayer},otherPlayers:function(){var t=this;return this.game.players.filter(function(e){return e.id!==t.me.id})}}},V={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Controls",{attrs:{game:t.game,me:t.me,markedCards:t.markedCards},on:{action:t.unmarkAll}}),t._v(" "),t.game.started?s("MyHand",{attrs:{me:t.me,markedCards:t.markedCards},on:{toggleMark:t.toggleMark}}):t._e(),t._v(" "),t.otherPlayers?s("Players",{attrs:{players:t.otherPlayers,baseMove:t.baseMove,currentPlayer:t.currentPlayer}}):t._e()],1)},staticRenderFns:[]};var Y=s("VU/8")(F,V,!1,function(t){s("Q0wr")},null,null).exports,L={props:{connected:{type:Boolean,default:!1}},methods:{handleClick:function(){this.connected||this.$emit("reconnect")}},computed:{statusText:function(){return this.connected?"Connected to server":"Not connected. Click to try again"},statusClass:function(){return this.connected?"is-success":"is-danger"},statusIcon:function(){return this.connected?"fa-check":"fa-refresh"}}},W={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"container breathe"},[e("a",{staticClass:"button is-pulled-right is-small",class:this.statusClass,on:{click:this.handleClick}},[e("span",{staticClass:"icon is-small"},[e("i",{staticClass:"fa",class:this.statusIcon})]),this._v(" "),e("span",[this._v(this._s(this.statusText))])])])},staticRenderFns:[]};var B={components:{Start:A,Game:Y,ConnectionStatus:s("VU/8")(L,W,!1,function(t){s("IpWz")},null,null).exports},name:"Wrapper",computed:Object(m.b)({game:"game",me:"me",errors:"errors",socket:"socket"}),methods:{dispatchAction:function(t){console.log("hej"),this.$store.dispatch("SEND_ACTION",t)},clearKeyError:function(){this.$store.commit("SET_INVKEY_ERROR","")},clearNickError:function(){this.$store.commit("SET_NICKNAME_ERROR","")},connect:function(){this.$store.dispatch("CONNECT")}},created:function(){this.connect()}},J={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ConnectionStatus",{attrs:{connected:t.socket.connected},on:{reconnect:t.connect}}),t._v(" "),t.game.invKey?s("Game",{attrs:{me:t.me,game:t.game}}):s("Start",{attrs:{errors:t.errors,urlKey:t.$route.params.key},on:{action:t.dispatchAction,changeKey:t.clearKeyError,changeNick:t.clearNickError}})],1)},staticRenderFns:[]};var j=s("VU/8")(B,J,!1,function(t){s("uPVN")},"data-v-4fbd28ee",null).exports;a.a.use(v.a);var Q,q,Z,z,X,tt=[{path:"/:key",component:j},{path:"/",component:j}],et=new v.a({base:"/chicago/",routes:tt,mode:"history"}),st={state:{host:{id:""},invKey:"",players:[],started:!1,round:{currentPlayer:"",phase:"",tricks:[]}},mutations:d()({},"MIRROR_GAME_STATE",function(t,e){t.host.id=e.host.id,t.invKey=e.invitationKey,t.players=e.players,t.started=e.started,t.hasWinners=e.hasWinners,e.currentRound&&(t.round.currentPlayer=e.currentRound.currentPlayer,t.round.phase=e.currentRound.phase,t.round.tricks=e.currentRound.tricks)}),actions:d()({},"HANDLE_SNAPSHOT",function(t,e){var s=t.commit,n=JSON.parse(e);et.push(n.game.invitationKey),s("SET_MY_TURN",n.myTurn),s("SET_MY_HAND",n.myHand),s("SET_MY_PLAYER",n.me),console.log(n),s("MIRROR_GAME_STATE",n.game)})},nt={state:{nickname:"",invKey:""},mutations:(Q={},d()(Q,"SET_NICKNAME_ERROR",function(t,e){t.nickname=e}),d()(Q,"SET_INVKEY_ERROR",function(t,e){t.invKey=e}),Q),actions:(q={},d()(q,"HANDLE_GAME_ERROR",function(t,e){t.state;window.alert(e)}),d()(q,"HANDLE_JSON_ERROR",function(t,e){t.state;window.alert("Something went wrong! Please try again")}),q)},at=function t(e){_()(this,t);var s=JSON.parse(e.data),n=s.type,a=s.body;this.type=n,this.body=a},it={connected:!1,socket:void 0},rt=(Z={},d()(Z,"SET_CONNECTED_TRUE",function(t){t.connected=!0}),d()(Z,"SET_CONNECTED_FALSE",function(t){t.connected=!1}),d()(Z,"SET_SOCKET",function(t,e){t.socket=e}),Z),ct={state:it,actions:(z={},d()(z,"CONNECT",function(t){var e=t.commit,s=t.dispatch,n=new WebSocket("ws://localhost:8080/chicago/game");n.onopen=function(){return e("SET_CONNECTED_TRUE")},n.onclose=function(){return e("SET_CONNECTED_FALSE")},n.onmessage=function(t){return s("HANDLE_MESSAGE",t)},e("SET_SOCKET",n)}),d()(z,"HANDLE_MESSAGE",function(t,e){var s=t.commit,n=t.dispatch,a=new at(e);switch(a.type){case"KEY_ERROR":s("SET_INVKEY_ERROR",a.body);break;case"NICKNAME_ERROR":s("SET_NICKNAME_ERROR",a.body);break;case"GAME_ERROR":n("HANDLE_GAME_ERROR",a.body);break;case"JSON_ERROR":n("HANDLE_JSON_ERROR",a.body);break;case"SNAPSHOT":n("HANDLE_SNAPSHOT",a.body);break;default:console.log("unknown message type:",a.body)}}),d()(z,"SEND_ACTION",function(t,e){t.state.socket.send(y()(e))}),z),mutations:rt};a.a.use(m.a);var ot=new m.a.Store({modules:(X={},d()(X,"me",h),d()(X,"game",st),d()(X,"errors",nt),d()(X,"socket",ct),X)});a.a.config.productionTip=!1,a.a.mixin({methods:{getCardUrl:function(t){return"/chicago/static/cards/"+t.value+"_"+t.suit+".svg"},getAvatarUrl:function(t){return"https://api.adorable.io/avatars/"+t.id}}}),new a.a({store:ot,router:et,el:"#app",render:function(t){return t(l)}}).$mount("#app")},Q0wr:function(t,e){},U1vt:function(t,e){},"ia/M":function(t,e){},uPVN:function(t,e){},wF0S:function(t,e){},wxSZ:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.ad42f37bd58506e5a7d6.js.map